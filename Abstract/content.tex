\subsection*{Общая характеристика работы}

\newcommand{\actuality}{\underline{\textbf{Актуальность темы исследования.}}}
\newcommand{\aim}{\underline{\textbf{Целью}}}
\newcommand{\tasks}{\underline{\textbf{задачи}}}
\newcommand{\defpositions}{\underline{\textbf{Положения, выносимые на~защиту:}}}
\newcommand{\novelty}{\underline{\textbf{Научная новизна:}}}
\newcommand{\influence}{\underline{\textbf{Практическая значимость:}}}
\newcommand{\methodology}{\underline{\textbf{Методы исследования.}}}
\newcommand{\reliability}{\underline{\textbf{Достоверность}}}
\newcommand{\probation}{\underline{\textbf{Апробация результатов.}}}
\newcommand{\contribution}{\underline{\textbf{Личный вклад.}}}
\newcommand{\implement}{\underline{\textbf{Внедрение результатов.}}}
\newcommand{\publications}{\underline{\textbf{Публикации.}}}
\newcommand{\structure}{\underline{\textbf{Структура и объем работы.}}}

\input{../common/characteristic} % Характеристика работы по структуре во введении и в автореферате не отличается (ГОСТ Р 7.0.11, пункты 5.3.1 и 9.2.1), потому её загружаем из одного и того же внешнего файла, предварительно задав форму выделения некоторым параметрам

%\underline{\textbf{Объем и структура работы.}} Диссертация состоит из~введения, четырех глав, заключения и~приложения. Полный объем диссертации \textbf{ХХХ}~страниц текста с~\textbf{ХХ}~рисунками и~5~таблицами. Список литературы содержит \textbf{ХХX}~наименование.

\structure\ Диссертационная работа состоит из введения, четырех глав, заключения, списка литературы и трех приложений. Полный объем работы составляет 132 страницы текста с 44 рисунками и 11 таблицами. Список литературы содержит 150 наименований. 

%\newpage
\subsection*{Содержание работы}

\underline{\textbf{Во введении}} обоснована актуальность темы исследования, сформулированы цель работы, научная новизна и практическая значимость полученных результатов, представлены положения, выносимые на защиту.

% -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
% -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\underline{\textbf{В первой главе}} рассмотрена история развития имплантируемых роторных насосов крови (РНК) в аппаратах вспомогательного кровообращения (АВК), продемонстрировано многообразие имплантируемых роторных насосов крови, применяемых в современной клинической практике.

Представлен аналитический обзор литературных источников, посвященных проблеме идентификации имплантируемых роторных насосов крови. Актуальной данную проблему делает многообразие роторных насосов крови, их сложное взаимодействие с сердечно-сосудистой системой.

Рассмотрены различные структуры математических моделей, полученные в результате идентификации, описано применение математических моделей для управления имплантируемыми РНК в аппаратах вспомогательного кровообращения.

% Выделены следующие типы управления: управление, направленное на поддержание заданного уровня расхода, и управление, направленное на предотвращение нежелательных состояний в сердечно-сосудистой системе, таких как коллапс желудочка сердца. Наиболее распространенным является первый тип управления.

Выявлено, что не существует универсального и общепринятого алгоритма идентификации, таким образом задача идентификации решается индивидуально для каждого насоса. Отмечено, что идентификация в общем случае направлена на повышение точности аппроксимации исходных экспериментальных данных математической моделью; построенные в результате идентификации математические модели, как правило, применяются для управления расходом имплантируемого роторного насоса крови.

Известная работа по идентификации имплантируемого РНК [9] заключается в параметрической идентификации и не исследует влияние изменений в структуре математической модели на точность аппроксимации экспериментальных данных или эффективность управления. Таким образом, недостаточное внимание уделяется исследованию структуры математической модели, а также применению идентифицированной математической модели к управлению имплантируемыми роторными насосами крови в аппаратах вспомогательного кровообращения.

Отмечено, что для корректной идентификации необходимо учесть взаимодействие насосов с сердечно-сосудистой системой, что требует проведения комплексного исследования, которое должно привести к повышению эффективности идентификации и управления имплантируемыми РНК.

% Помимо этого рассмотрена проблема идентификации имплантируемых РНК, т.\:е. построения математических моделей по экспериментальным данным; проведен сравнительный анализ способов идентификации РНК. Указано, что для корректной идентификации требуется учесть взаимодействие насосов с сердечно-сосудистой системой. 


% насосов крови необходимо учитывать взаимодействие насоса и сердечно-сосудистой системы, которые образуют сложную систему. 

%При этом проведен анализ подходов к идентификации РНК, а также рассмотрены  возможности для управления РНК, которые обеспечивают построенные в результате идентификации математические модели.  

% Рассматриваются различные подходы к идентификации, описанные в работах.  Указывается, что все подходы различны и нет единого или универсального способа идентификации, что обусловлено тем-то (сложность идентификации - насосы разные).

% -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
% -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\underline{\textbf{Во второй главе}} описывается разработка математической модели идентификации имплантируемого роторного насоса крови и математической модели сердечно-сосудистой системы с учетом имплантации РНК.

Первоначально решалась задача идентификации на основе расходно-напорных характеристик (РНХ) имплантируемого роторного насоса крови HeartMate II. 

Для решения данной задачи был разработан алгоритм структурно-параметрической идентификации, схема которого представлена на рисунке \ref{img:flowchart}.

\begin{figure}[!ht]
\centering
\begin{tikzpicture}[node distance=1cm, auto]  

\tikzstyle{startstop} = [rectangle, rounded corners=10pt, minimum width=3.0cm, minimum height=1.35cm,text centered, draw=black]
\tikzstyle{io} = [trapezium, trapezium left angle=70, trapezium right angle=110, minimum width=0.9cm, minimum height=1.1cm, text centered, draw=black]
\tikzstyle{process} = [rectangle, minimum width=1.1cm, minimum height=1.3cm, text centered, draw=black]
\tikzstyle{decision} = [diamond, minimum width=3.0cm, minimum height=1.35cm, text centered, draw=black]
\tikzstyle{arrow} = [thick,->,>=stealth]

\node (s) [startstop, yshift=-20.0, minimum height=0.9cm] {\parbox{4.5cm}{\small \centering Начало}};
\node (start) [process, below of=s, yshift=-20.0] {\parbox{5.95cm}{\small Задание исходного уравнения $y_i$ где $i$ -- номер итерации }};
\node (in1) [io, below of=start, yshift=-1.05cm] {\parbox{5.55cm}{\small Добавление к $y_i$ одночлена $kx_j$ где $k$ -- коэффициент \\ $j$ -- номер одночлена}};
\node (pro1) [process, below of=in1, yshift=-1.50cm] {\parbox{7.80cm}{\small Определение коэффициентов $y_i + kx_j$ с \\использованием процедуры оптимизации \\ Проверка соответствия критерию оценки эффективности идентификации}};
\node (dec1) [decision, below of=pro1, yshift=-1.30cm] {};% {\footnotesize\bf \parbox{1.5cm}{Соответствие \\ критериям}};
\node (dec2) [decision, below of=dec1, yshift=-0.75cm] {};
\node (out2a) [process, right of=dec2, yshift=0.0cm, xshift=5.2cm, minimum width=1.0cm] {\parbox{4.15cm}{\small Задание $y_i + kx_j$ \\исходным уравнением \\ $i = i + 1$ \\ $j = j + 1$}};
\node (out2b) [io, left of=dec1, xshift=-5.3cm, minimum width=1.0cm] {\parbox{3.70cm}{\small Исключение $y_i + kx_j$ \\ $j = j + 1$}};
\node (out2c) [process, below of=dec2, yshift=-0.8cm, minimum height=1.0cm] {\small Окончательное $y_i + kx_j$};
\node (out) [startstop, below of=out2c, yshift=-0.5cm, minimum height=0.9cm] {\parbox{4.5cm}{\small \centering Конец}};

\draw [arrow] (s) -- (start);
\draw [arrow] (start) -- (in1);
\draw [arrow] (in1) -- (pro1);
\draw [arrow] (pro1) -- (dec1);
\draw [arrow] (out2c) -- (out);
\draw [arrow] (dec2) -- node[anchor=south] {\small нет} (out2a);
\draw [arrow] (dec1) -- node[anchor=south] {\small нет} (out2b);
\draw [arrow] (dec1) -- node[anchor=west] {\small ~да} (dec2);
\draw [arrow] (dec2) -- node[anchor=west] {\small ~да} (out2c);
\draw [arrow] (out2a) |- ($(in1.east)+(0,-0.1)$);
\draw [arrow] (out2b) |- ($(in1.west)+(0.05,0.1)$);
%\draw [arrow] (out2b) ($(out2b.east)$)|- + (2.5,0) |- ($(in1.east)+(0.05,0.1)$); 
\draw (0.0, -9.33) node {\small $R^2_{ij} > R^2_i$}; %  \\ $\delta(PS) \geq 85\%$
\draw (0.0, -11.05) node {\small $R^2_{ij} \geq 0,9980$}; %  \\ $\delta(PS) \geq 85\%$
\end{tikzpicture} 
\caption{Схема алгоритма структурно-параметрической идентификации имплантируемого роторного насоса крови} 
\label{img:flowchart}  
\end{figure}

Основная идея алгоритма идентификации заключается в поиске структуры математической модели путем последовательного добавления одночленов $kx_j$ к исходному уравнению $y_i$. На каждой итерации $i$ осуществляется отбор уравнений вида $y_i + kx_j$ посредством проверки соответствия критериям оценки эффективности идентификации. %, что позволяет отобрать информативные одночлены $kx_j$.

В качестве исходного уравнения $y_i$ выбрано уравнение со следующей структурой согласно работам [9--10]: 

% В качестве экспериментальных данных для разработки модели идентификации выбраны расходно-напорные характеристики (РНХ) имплантируемого роторного насоса крови HeartMate II. Исходное уравнение для моделирования РНХ записывается в следующем виде:

\begin{equation}
	\label{eq:initial_eq}
	L\frac{dQ}{dt} = (a_1\mu+a_2)Q + (b_1\mu+b_2)\omega^2 + H,
\end{equation}

% уравнение \eqref{eq:initial_eq}. 
% Для моделирования РНХ было выбрано 

\noindent где $L$ -- параметр, характеризующий инерцию жидкости в насосе (мм рт. ст.$~\cdot$ мин$^2~\cdot$ л$^{-1}$) [9], $Q$ -- расход насоса (л/мин), $\mu$ -- параметр, характеризующий вязкость жидкости в насосе (сП), $\omega$ -- скорость вращения ротора насоса (об/мин), $H$ -- перепад давления в насосе (мм рт. ст.). Параметры $\mu$, $\omega$ и $H$ можно считать постоянными независимыми параметрами. Коэффициенты $a$ и $b$ также постоянны, их числовые значения рассчитываются с использованием разработанной процедуры оптимизации на основе алгоритма Левенберга-Марквардта. 

Список одночленов $kx_j$ сформирован в ходе анализа математических моделей имплантируемых роторных насосов крови, описанных в литературе. 

В качестве критерия, позволяющего оценить эффективность идентификации, выбран коэффициент детерминации $R^2$:

\begin{equation}
	\label{eq:r_squared}
		R^2 = 1- \frac{{\sum\limits_{i=1}^n} (Q_i - \hat{Q_i})^2}{{\sum\limits_{i=1}^n} (Q_i - \tilde{Q_i})^2}, %~~~~\widetilde{Q_i} = \frac{1}{n} \sum\limits_{i=1}^n Q_i
\end{equation}

\noindent где $Q_i$ -- прогноз математической модели, $\hat{Q_i}$ -- фактическое значение, $\tilde{Q_i}$ -- среднее арифметическое значение прогнозов математической модели. 

В ходе моделирования расходно-напорных характеристик пороговое значение коэффициента детерминации было выбрано равным 0,9980 и более, поскольку при данных значениях достигалось соответствие моделируемых и экспериментальных РНХ и, таким образом, точная идентификация характеристик насоса.

% Коэффициенты математической модели определялись . %; оптимизация производилась по . 

% Для идентификации имплантируемого роторного насоса крови 

% В результате установлено, что уравнение \eqref{eq:initial_eq} неприемлемо для описания экспериментальных РНХ -- рисунок \ref{img:pump_model_development}а. Решением данной проблемы стала разработка алгоритма идентификации с использованием экспериментальных характеристик. Блок-схема алгоритма 

В результате применения алгоритма идентификации поэтапно была построена математическая модель идентификации. Так, с математической моделью, представленной уравнением \eqref{eq:initial_eq}, было достигнуто значение $R^2$ равное 0,9566; моделируемые расходно-напорные характеристики представлены на рисунке \ref{img:pump_model_development}а, где круглыми маркерами отмечены точки, по которым проводилась идентификация. 

Данный результат был улучшен с помощью добавления членов $Q^2$ и $Q^3$, что позволило увеличить $R^2$ до 0,9738 и моделировать $S$-образный изгиб расходно-напорной характеристики, характерный для насоса HeartMate II -- рисунок \ref{img:pump_model_development}б. 

Полученное уравнение записывается в следующем виде: 

\begin{equation}
	\label{eq:first_step_pump_model}
	L\frac{dQ}{dt} = (a_1\mu+a_2)Q + (b_1\mu+b_2)\omega^2 + (c_1\mu+c_2)Q^2 + (d_1\mu+d_2)Q^3 - H.
\end{equation}

\begin{figure}[ht]
  \begin{minipage}[ht]{0.48\linewidth}
    \center{\includegraphics [scale=0.99] {../images/static_model_initial_abs} \\ а)}
  \end{minipage}
  \hfill
  \begin{minipage}[ht]{0.48\linewidth}
    \center{\includegraphics [scale=0.99] {../images/static_model_updated_abs} \\ б)}
  \end{minipage}
  \caption{Расходно-напорные характеристики роторного насоса крови, описываемые уравнением 1 (а) и уравнением 2 (б)}
  \label{img:pump_model_development}  
\end{figure}

После этого к уравнению \eqref{eq:first_step_pump_model} были добавлены члены $Q\omega^2$ и $Q^2 \omega$, а также поправочный коэффициент $g = g_1\mu +g_2$, что позволило увеличить коэффициент детерминации до 0,9987, достичь соответствия моделируемых и экспериментальных РНХ и завершить работу алгоритма.  

Разработанная с использованием алгоритма идентификации математическая модель записывается в следующем виде: 

\begin{multline}
 L\frac{dQ}{dt} = (a_1\mu+a_2)Q + (b_1\mu+b_2)Q^2 + (c_1\mu+c_2)Q^3 + (d_1\mu+d_2)\omega^2 + \\+ (e_1\mu+e_2)Q\omega^2 + (f_1\mu+f_2)Q^2\omega + g_1\mu+g_2 - H.
\label{eq:final_pump_model}
\end{multline}

Поскольку состояние РНК описывается единственной переменной $Q$, то фазовое пространство уравнения \eqref{eq:final_pump_model} одномерно и представлено вещественной прямой $0Q$. Поэтому для наглядности будем изображать эволюцию уравнения \eqref{eq:final_pump_model}, откладывая по оси абсцисс время $t$, по оси ординат -- фазовую переменную $Q$:

\begin{figure}[ht] 
  \center
  \includegraphics [scale=1.0] {../images/dynamic_model_solution_zero_abs}
  \caption{Зависимость $Q$ от времени при различных начальных условиях}
  \label{img:final_pump_model_solution_zero}  
\end{figure}

На рисунке \ref{img:final_pump_model_solution_zero} представлено изменение $Q$ от времени при фиксированных параметрах $\mu = $ 3,6 сП, $\omega =$ 8000 об/мин и $H = $ 20 мм рт. ст. Видно, что с течением времени значения переменной $Q$ стремятся к некоторому особому значению $Q^*$. При этом значения достаточно быстро выходят на $Q^*$. 

Найдем особые точки уравнения \eqref{eq:final_pump_model}, приравняв левую часть уравнения \eqref{eq:final_pump_model} к нулю:

\begin{multline}
(a_1\mu+a_2)Q + (b_1\mu+b_2)Q^2 + (c_1\mu+c_2)Q^3 + (d_1\mu+d_2)\omega^2 + \\+ (e_1\mu+e_2)Q\omega^2 + (f_1\mu+f_2)Q^2\omega + g_1\mu+g_2 - H = 0.
\label{eq:final_pump_model_zero}
\end{multline}

Уравнение \eqref{eq:final_pump_model_zero} решено с использованием формулы Кардано для нахождения корней $x_1$, $x_2$ и $x_3$ уравнения вида $ax^3 + bx^2 + cx + d = 0$:

\begin{equation}
x_1 = -\frac{b}{3a} + \alpha + \beta, \quad x_{2, 3} = -\frac{b}{3a}  - \frac{(\alpha + \beta)}{2} \pm \frac{i(\alpha - \beta)}{2}\sqrt{3},
\label{eq:cardano_1}
\end{equation}

где 

\begin{equation}
\alpha = \sqrt[3]{-\frac{q}{2} + \sqrt{R}}, \quad \beta = \sqrt[3]{-\frac{q}{2} - \sqrt{R}},
\label{eq:cardano_2}
\end{equation}

\begin{equation}
R = \left(\frac{p}{3}\right)^3 + \left( \frac{q}{2} \right)^2,
\label{eq:cardano_3}
\end{equation}

\begin{equation}
p = \frac{3ac - b^2}{3a^2}, \quad q = \frac{2b^3 - 9abc + 27a^2d}{27a^3}.
\label{eq:cardano_extension}
\end{equation}

Для уравнения \eqref{eq:final_pump_model_zero} $R > 0$, таким образом, уравнение \eqref{eq:final_pump_model_zero} имеет один вещественный корень и два сопряженных комплексных корня, следовательно, при всех физически реализуемых $\mu$, $\omega$ и $H$ особая точка уравнения \eqref{eq:final_pump_model} единственна.% Система для 

%При определенных значениях $\omega$ и $H$ были получены решения, представленные на рисунке \ref{img:final_pump_model_solution}, где маркерами отмечены значения, которые получены в результате численного решения уравнения \eqref{eq:final_pump_model} при $LdQ/dt$ равном нулю с использованием функции \href{https://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.optimize.fsolve.html}{fsolve} из программной библиотеки SciPy.

%\begin{figure}[ht] 
%  \center
%  \includegraphics [scale=1.0] {../images/c2_dynamic_model_solution_abs}
 % \caption{Решение уравнения \eqref{eq:final_pump_model_discret} при различных параметрах $\omega$ и $H$} 
 % \label{img:final_pump_model_solution}  
%\end{figure}

% Решение кубического уравнения, полученного из уравнения \eqref{eq:final_pump_model} посредством приравнивания левой части $LdQ/dt$ к нулю, при определенных значениях $\omega$ и $H$, представлено на рисунке \ref{img:final_pump_model_solution_roots}.



Расходно-напорные характеристики РНК, описываемые разработанной математической моделью идентификации, представлены на рисунке \ref{img:final_pump_model}.

% Разработанная математическая модель идентификации позволяет описать расходно-напорные характеристики, представленные на рисунке \ref{img:final_pump_model}.

\begin{figure}[ht] 
  \center
  \includegraphics [scale=1.0] {../images/static_model_final_abs}
  \caption{Расходно-напорные характеристики роторного насоса крови, описываемые уравнением \eqref{eq:final_pump_model}} 
  \label{img:final_pump_model}  
\end{figure}

В рамках данного исследования на основе известных математических моделей реализована математическая модель сердечно-сосудистой системы с учетом имплантации роторного насоса крови, которая составлена из математических моделей сердца [11] и системы кровообращения [12] и описывает гемодинамику в сердечно-сосудистой системе с сердечной недостаточностью -- рисунок \ref{img:cvs_hemodynamics}.

\begin{figure}[ht] 
  \center
  \includegraphics [scale=1.0] {../images/cvs_hemodynamics_abs} 
  \caption{Гемодинамика в сердечно-сосудистой системе для случая сердечной недостаточности; $P_{LV}$ -- давление в левом желудочке, $P_{RV}$ -- давление в правом желудочке, $P_{Ao}$ -- давление в аорте, $P_{PA}$ -- давление в легочной артерии, $P_{CV}$ -- центральное венозное давление, $P_{PCW}$ -- давление заклинивания в легочных капиллярах, ЛЖ -- левый желудочек сердца, \\ПЖ -- правый желудочек сердца}
  \label{img:cvs_hemodynamics}
\end{figure}

% -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
% -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\underline{\textbf{В третьей главе}} проведено исследование взаимодействия имплантируемого роторного насоса крови и сердечно-сосудистой системы методами математического моделирования. 

%В ходе моделирования получены динамические расходно-напорные характеристики насоса, представленные на рисунке \ref{img:full_dynamic_model}. 

%В ходе исследования выявлена нелинейная форма РНХ, которая обусловлена переходными процессами в роторном насосе крови -- рисунок \ref{img:dynamic_model}. Входными данными математической модели являются временные диаграммы перепада давления при двух значениях параметра $\omega$, выходными данными математической модели являются временные диаграммы расхода насоса.

%\begin{figure}[ht] 
%  \center
%  \includegraphics [scale=1.0] {../images/c2_dynamic_model_edit_abs}
%  \caption{Временные диаграммы расхода и перепада давления (слева) и соответствующие расходно-напорные характеристики роторного насоса крови при 7000 об/мин и 9000 об/мин %(справа)} 
%  \label{img:dynamic_model}
%\end{figure}

В ходе исследования получены зависимости, описывающие изменения в гемодинамике сердечно-сосудистой системы при различных скоростях насоса -- рисунок \ref{img:pumping_states_general}. 

\begin{figure}[!ht] 
  \center
  \noindent\includegraphics [scale=1.0] {../images/pumping_states_abs}
  \caption{Гемодинамические зависимости, полученные на математической модели сердечно-сосудистой системы; $Q_{P[min]}$ -- минимальный расход насоса (л/с), $Q_{AV}$ -- поток через аортальный клапан (л/мин), $P_{PCW}$ -- давление заклинивания в легочных капиллярах (мм рт. ст.)} 
  \label{img:pumping_states_general}  
\end{figure}

Полученные зависимости позволяют определить следующие режимы работы насоса: обратное течение через насос ($P_{BF}$), частичная разгрузка ($P_{PA}$) и полная разгрузка желудочка сердца ($P_{FA}$), коллапс желудочка сердца ($P_{VC}$). 

Так, режиму обратного течения $P_{BF}$ соответствует диапазон скоростей насоса с отрицательным расходом во время сердечного цикла -- данный диапазон выделен серым цветом на диаграмме $Q_{P[min]}$. Аналогичным образом режимам работы $P_{PA}$ и $P_{FA}$ соответствуют диапазоны скоростей с ненулевым и нулевым потоками через аортальный клапан, которые выделены соответственно светло-серым и серым цветом на диаграмме $Q_{AV}$; режиму коллапса желудочка сердца $P_{VC}$ соответствует диапазон скоростей с отрицательным давлением, который выделен серым цветом на диаграмме $P_{PCW}$.

% Таким образом, на рисунке \ref{img:pumping_states_general} синим цветом на зависимости $Q_{P[min]}$ обозначен диапазон скоростей насоса, которому соответствует режим обратного течения. 

В результате анализа закономерностей взаимодействия имплантируемого роторного насоса крови и сердечно-сосудистой системы на основе модели идентификации разработан метод определения режимов работы насоса. Метод заключается в нахождении производных из модели идентификации, вычислении их значений при различных скоростях насоса и определении тех производных, изменение которых коррелирует с режимами работы насоса. 

Разработанный метод характеризуется точностью определения перехода между режимами работы насоса, которая рассчитывается по следующей формуле:

\begin{equation}
	\label{eq:ps_identification_accuracy}
	\delta(PS) = \left(1 - \frac{\lvert\hskip2pt \omega_t - \omega_m \rvert}{\omega_{max} - \omega_{min}} \right) \cdot 100\%,
\end{equation}

\noindent где $\omega_t$ -- практическое значение скорости насоса, при которой происходит переход между режимами работы, $\omega_m$ -- полученное из метода расчетное значение скорости насоса, при которой происходит переход между режимами работы, $\omega_{max}$ и $\omega_{min}$ -- верхняя и нижняя граница скорости вращения ротора насоса.

Результаты расчета точности при изменении сократимости левого желудочка сердца и частоты сердечных сокращений для трех значений параметра $\mu$ модели идентификации представлены в таблице \ref{tbl:ps_identification_accuracy_model}. %Приведенные значения являются средними при изменении сократимости левого желудочка сердца на $\pm$10\% и частоте сердечных сокращений от 60 до 100 уд/мин с шагом 20 уд/мин.

\begin{table} [htbp]%
    \centering
	\caption{Точность определения переходов между режимами работы насоса ($\delta(PS)$, \%)}%
	\label{tbl:ps_identification_accuracy_model}%
    \renewcommand{\arraystretch}{1.5} 
	\begin{tabular}{@{}@{\extracolsep{22pt}}llll@{}} 
	\toprule
	& $\mu = $ 3,6 сП & $\mu = $ 2,2 сП & $\mu = $ 1,0 сП\\
	\midrule
	$\delta(P_{BF}/P_{PA})$			& 88,7		&	87,5 & 85,4\\
	$\delta(P_{PA}/P_{FA})$				& 98,0		& 97,9	& 97,6\\
	%$\delta(P_{FA}/P_{PVC})$			& 90,6		& 94,5	& 94,4\\
	$\delta(P_{FA}/P_{VC})$		& 82,7		& 83,4	& 82,6\\
    \bottomrule 
	\end{tabular}%
\end{table}

В результате проведенного комплексного исследования разработан способ управления имплантируемым роторным насосом крови, представленный с помощью системы управления скоростью РНК на рисунке \ref{img:control_algorithm}. 

%Управление насосом заключается в регулировании скорости вращения ротора. 

\begin{figure}[ht] 
  \center
  \includegraphics [scale=1.66] {../images/c3_control_algorithm}
  \caption{Обобщенная структура системы управления скоростью роторного насоса крови} 
  \label{img:control_algorithm}  
\end{figure}

В \textit{оценочном блоке} с использованием модели идентификации осуществляется определение режима работы и оценка расхода насоса по данным о перепаде давления в насосе ($H$, мм рт. ст.), который регистрируется в математической модели сердечно-сосудистой системы, скорости вращения ротора ($\omega$, об/мин) и вязкости жидкости ($\mu$, сП), которые задаются в \textit{блоке управления насосом}. 
 
В \textit{блоке регулирования скорости} формируется новое значение скорости вращения ротора $\omega(t+1)$, которое зависит от текущего режима работы насоса и от разности $Q_A$ и $Q_D$, где $Q_A$ -- расход насоса в течение нескольких сердечных циклов и $Q_D$ -- заданный уровень расхода насоса. 

В случае неравенства $Q_A$ и $Q_D$ происходит изменение скорости на 100 об/мин. При выявлении нежелательного режима работы насоса, такого как $P_{VC}$, скорость вращения ротора уменьшается на 500 об/мин независимо от разности $Q_A$ и $Q_D$. % независимо от величины $Q_A$ 

Разработанный способ управления скоростью имплантируемого роторного насоса крови исследован на математической модели сердечно-сосудистой системы при изменении сократимости левого желудочка сердца и частоты сердечных сокращений. Результаты продемонстрировали возможность поддержания заданного уровня расхода насоса и предотвращения следующих нежелательных режимов работы насоса: обратное течение через насос, полная разгрузка желудочка сердца и коллапс желудочка сердца. 

В результате анализа разработанного способа управления предложены следующие критерии оценки эффективности идентификации: точность оценки расхода насоса и точность определения перехода между режимами работы насоса.

% -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
% -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

\underline{\textbf{В четвертой главе}} проведено исследование взаимодействия насоса и сердечно-сосудистой системы с использованием экспериментальных данных для имплантируемых роторных насосов крови Спутник.
%\paragraph{Протокол исследования.}

Фотографии насосов -- далее Спутник 1 и Спутник 2 -- представлены на рисунке \ref{img:sputnik_pumps}. % 

% \begin{figure}[ht]
%   \begin{minipage}[ht]{0.42\linewidth}
%     \center{\includegraphics [scale=0.47] {../images/s1_pump_abs} \\ а)}
%   \end{minipage} 
%   \hfill
%   \begin{minipage}[ht]{0.54\linewidth}
%     \center{\includegraphics [scale=0.47] {../images/s2_pump_abs} \\ б)}
%   \end{minipage}
%   \caption{Имплантируемые роторные насосы крови Спутник первого (а) и второго поколений (б)}
%   \label{img:sputnik_pumps}  
% \end{figure}

\begin{figure}[ht]
  \begin{minipage}[ht]{0.48\linewidth}
    \center{\includegraphics [scale=0.225] {../images/s1_abs} \\ а)}
  \end{minipage}
  \hfill
  \begin{minipage}[ht]{0.48\linewidth}
    \center{\includegraphics [scale=0.225] {../images/s2_abs} \\ б)}
  \end{minipage}
  \caption{Имплантируемые роторные насосы крови Спутник первого (а) \\и второго поколений (б)}
  \label{img:sputnik_pumps}  
\end{figure}

% \begin{figure}[ht]
%   \center{\includegraphics [scale=0.50] {../images/c5_Sputniks}}
% %   \begin{minipage}[ht]{0.49\linewidth}
% %     \center{\includegraphics [scale=1.0] {../images/c5_sputnik_1} \\ а)}
% %   \end{minipage}
% %   \hfill
% %   \begin{minipage}[ht]{0.49\linewidth}
% %     \center{\includegraphics [scale=0.93] {../images/c5_sputnik_2} \\ б)}
% %   \end{minipage}
%   \caption{Имплантируемые роторные насосы крови Спутник первого (слева) и второго поколений (справа)}
%   \label{img:sputnik_pumps}  
% \end{figure}

Эксперимент проведен в испытательном гидродинамическом стенде, расположенном в Институте Гельмгольца по биомедицинской инженерии (г. Ахен, Германия) [13]. Схема гидродинамического стенда представлена на рисунке \ref{img:mcl}. Система управления стендом с помощью специальных приводных механизмов формировала давления в камерах $C_{in}$ и $C_{out}$, что позволяло создать перепад давления в системе аналогично сердечно-сосудистой системе.

\begin{figure}[!ht] 
  \center
  \includegraphics [scale=1.8] {../images/mcl_scheme_abs}
\begin{tikzpicture}[node distance=1cm, auto, overlay]  
\draw (-5.75, 6.59) node {\small \scalebox{1.075}{Система управления испытательным стендом}}; %  \\ $\delta(PS) \geq 85\%$
\end{tikzpicture} 
  \caption{Схема испытательного гидродинамического стенда} 
  \label{img:mcl}  
\end{figure}

Вязкость жидкости в контуре гидродинамического стенда равнялась 2,5 сП, частота сердечных сокращений -- 80 уд/мин, скорость вращения ротора каждого насоса изменялась в диапазоне от 5 до 10 тысяч об/мин с шагом 200 об/мин. В стенде последовательно воспроизводились два состояния сердечно-сосудистой системы, соответствующие различным степеням сердечной недостаточности. Данные состояния были воспроизведены посредством задания физиологического параметра contractilityFactor (cF) равным 0,5 и 0,25, где cF равное 1 соответствует нормальной функции сердца.

%Скорость вращения ротора насоса изменялась в диапазоне от 5000 до 10000 об/мин с шагом 200 об/мин. На каждом шаге в течение примерно 30 секунд записывались данные о расходе насоса, скорости вращения ротора, давлении на входе и выходе насоса и потоке через аортальный клапан.

%\paragraph{Исследование алгоритма идентификации.}

% проведено исследование алгоритма идентификации с использованием результатов, полученных в ходе эксперимента. 

В рамках данного исследования были выбраны следующие критерии оценки эффективности идентификации: точность оценки расхода насоса и точность определения перехода между режимами работы насоса. Для выбранных критериев заданы следующие пороговые величины: средняя точность оценки расхода $\geq$ 90 \%, средняя точность определения перехода $\geq$ 80 \%. 

Точность оценки расхода насоса для каждой скорости вращения ротора рассчитывалась по следующей формуле:

\begin{equation}
	\delta(Q) = \left( 1 - (Q_M - Q_E)/Q_M \right) \cdot 100 \%,
\end{equation}

\noindent где $Q_M$ -- расход насоса, измеренный датчиком, $Q_E$ -- расход насоса, вычисленный с помощью математической модели. %Точность определения переходов между режимами работы насоса рассчитывалась согласно \eqref{eq:ps_identification_accuracy}. 

Точность определения перехода между режимами работы насоса рассчитывалась по формуле \eqref{eq:ps_identification_accuracy}. 

В ходе анализа экспериментальных данных режим коллапса желудочка сердца $P_{VC}$ был определен как отрицательное конечно-диастолическое давление в желудочке сердца. 

Первоначально для описания имплантируемых роторных насосов крови Спутник использована математическая модель идентификации, представленная уравнением \eqref{eq:final_pump_model}. Коэффициенты данной модели определены для состояния cF 0,5 с использованием разработанной процедуры оптимизации на основе алгоритма дифференциальной эволюции [14]. Оценка соответствия критериям эффективности идентификации выполнена посредством вычисления средней точности оценки расхода и точности определения переходов между режимами работы насоса для двух состояний сердечно-сосудистой системы с различными параметрами cF. 

Установлено, что средняя точность оценки расхода с использованием разработанной модели идентификации для Спутник 1 составляет 97,6\%, для Спутник 2 -- 82,5\%, точность определения перехода $P_{FA}/P_{VC}$ составляет менее 75\% для обоих насосов. 

Таким образом, разработанная модель идентификации не позволяет обеспечить соответствие заданным пороговым величинам для критериев оценки эффективности идентификации.

%С целью обеспечения соответствия заданным пороговым величинам использован разработанный алгоритм идентификации. При этом построение математической модели осуществлялось в соответствии с предложенными критериями для оценки эффективности идентификации. 
%Измененная блок-схема алгоритма идентификации представлена на рисунке \ref{img:flowchart_upd}.

Данная проблема решена посредством построения математических моделей с использованием алгоритма структурно-параметрической идентификации. В качестве исходного уравнения $y_i$ в алгоритме выбрано уравнение \eqref{eq:initial_eq}, заданный список одночленов $kx_j$ заменен на член $k\omega^xH^yQ^z$, где $k$ -- коэффициент, $x$, $y$ и $z$ $\in [-2 .. 4].$ % целые числа в диапазоне от -2 до 4. % в соответствии с критериями оценки эффективности идентификации

Построение математических моделей осуществлялось в соответствии с выбранными критериями оценки эффективности идентификации. Коэффициенты уравнений вида $y_i + k\omega^xH^yQ^z$ также определялись для состояния cF 0,5 с использованием разработанной процедуры оптимизации. В случае соответствия полученного уравнения только одному из критериев оценки эффективности идентификации запускался вложенный цикл алгоритма с добавлением членов $k\omega^xH^yQ^z$, определением коэффициентов уравнений и проверкой на соответствие критериям.

%В результате исследования были построены модели идентификации имплантируемых роторных насосов крови в соответствии с критериями для оценки эффективности идентификации.

% \begin{figure}[ht]
% \centering
% \begin{tikzpicture}[node distance=1cm, auto]  
% % \tikzset{
% %     mynode/.style={rectangle,rounded corners,draw=black, top color=white, bottom color=yellow!50,very thick, inner sep=1em, minimum size=3em, text centered},
% %     myarrow/.style={draw},
% % }
% 
% % \node[mynode] (top) {Государственная власть};  
% % \node[mynode, below=2cm of top] (center) {Судебная};
% % \node[mynode, left=of center] (left) {Законодательная};
% % \node[mynode, right=of center] (right) {Исполнительная};
% % 
% % \draw[myarrow] (top.south) -- (center.north);   
% % \draw[myarrow] (top.south) -- ++(0,-1) -|  (left.north);        
% % \draw[myarrow] (top.south) -- ++(0,-1) -|  (right.north);
% 
% \tikzstyle{startstop} = [rectangle, rounded corners, minimum width=1cm, minimum height=0.8cm,text centered, draw=black, fill=gray!10]
% \tikzstyle{io} = [trapezium, trapezium left angle=70, trapezium right angle=110, minimum width=1cm, minimum height=0.8cm, text centered, draw=black, fill=gray!10]
% \tikzstyle{process} = [rectangle, minimum width=1cm, minimum height=0.8cm, text centered, draw=black, fill=blue!30]
% \tikzstyle{decision} = [diamond, minimum width=3.0cm, minimum height=1.4cm, text centered, draw=black, fill=gray!10]
% \tikzstyle{arrow} = [thick,->,>=stealth]
% 
% \node (start) [startstop] {\small \parbox{5.7cm}{Задание исходного выражения и пороговых величин для критериев оценки эффективности}};
% \node (in1) [io, below of=start, yshift=-1.0cm] {\small \parbox{5.2cm}{Прибавление к исходному выражению члена $k\omega^xH^yQ^z$}};
% \node (pro1) [process, below of=in1, yshift=-1.1cm] {\small \parbox{6.4cm}{Оптимизация уравнения для cF 0,5.\\Проверка на соответствие пороговым величинам для cF 0,5 и cF 0,25}};
% \node (dec1) [decision, below of=pro1, yshift=-1.2cm] {};% {\footnotesize\bf \parbox{1.5cm}{Соответствие \\ критериям}};
% \node (out2a) [process, right of=dec1, xshift=5.2cm, minimum width=1.0cm, fill=yellow!40] {\small \parbox{5.0cm}{Задание \\ $LdQ/dt=\ldots + k\omega^xH^yQ^z$ исходным выражением}};
% \node (out2b) [io, left of=dec1, xshift=-3.5cm, minimum width=1.0cm, fill=red!40] {\small \parbox{2.0cm}{Исключение данного\\ уравнения}};
% \node (stop) [startstop, below of=dec1, yshift=-0.5cm, fill=green!40, yshift=-0.1cm] {\small Окончательное уравнение};
% 
% \draw [arrow] (start) -- (in1);
% \draw [arrow] (in1) -- (pro1);
% \draw [arrow] (pro1) -- (dec1);
% \draw [arrow] (dec1) -- (out2a);
% \draw [arrow] (dec1) -- (out2b);
% \draw [arrow] (dec1) -- (stop);
% \draw [arrow] (out2a) |- ($(in1.east)+(0,-0.1)$);
% \draw [arrow] (out2b) |- (in1.west);%($(start.south)!0.16!(pro1.north)$);
% % $(processing.south)-(0,0.5)$
% \draw [arrow] (dec1) -- node[anchor=south] {\footnotesize\it частично} (out2a);
% \draw [arrow] (dec1) -- node[anchor=north] {\footnotesize\it нет} (out2b);
% \draw [arrow] (dec1) -- node[anchor=west] {\footnotesize\it да} (stop);
% 
% \end{tikzpicture} 
% \caption{Блок-схема алгоритма идентификации роторного насоса крови} 
% \label{img:flowchart_upd}  
% \end{figure}

% \begin{enumerate}
%  \begin{itemize}
%   \item если ни один из критериев не выполнялся, то данное уравнения исключалась из рассмотрения,
%   \item если выполнялся хотя бы один из критериев, то уравнение вида $LdQ/dt = \ldots + \omega^xH^yQ^z$ задавалось в качестве исходного выражения и алгоритм повторялся с шага 1,
%   \item если все критерии оценки выполнялись, то процесс разработки заканчивался.
%  \end{itemize}
% \end{enumerate}

В результате применения алгоритма идентификации были построены математические модели, которые обеспечивают соответствие заданным пороговым величинам для критериев оценки эффективности идентификации. 

Математическая модель насоса Спутник 1 описывается следующим уравнением:

\begin{equation}
	\label{eq:sputnik_1_eq}
	L_1\frac{dQ}{dt} = a_1Q + b_1\omega^2 + c_1H + d_1HQ + e_1\omega^{-1} H^2 Q.
\end{equation}

Математическая модель насоса Спутник 2 описывается следующим уравнением:

\begin{equation}
	\label{eq:sputnik_2_eq}
	L_2\frac{dQ}{dt} = a_2Q + b_2\omega^2 + c_2H + d_2HQ^3 + e_2\omega^{-1}Q.
\end{equation}

%Точность определения переходов между режимами работы насоса и 

Средняя точность оценки расхода насоса и точность определения переходов между режимами работы, рассчитанные с помощью экспериментальных данных для Спутник 1 и Спутник 2, представлены в таблице \ref{tbl:sputnik_ps_identification_accuracy}. 

\begin{table} [htbp]%
    \centering
	\caption{Средняя точность оценки расхода насоса ($\delta(Q_{mean})$, \%) и точность определения перехода между режимами работы насоса ($\delta(PS)$, \%)\vskip5pt}%
	\label{tbl:sputnik_ps_identification_accuracy}% label всегда желательно идти после caption
    \renewcommand{\arraystretch}{1.5} 
	\begin{tabular}{@{}@{\extracolsep{22pt}}lllll@{}} 
	\toprule
	& \multicolumn{2}{c}{Спутник 1} & \multicolumn{2}{c}{Спутник 2} \\
	\midrule
				&	cF 0,5	& cF 0,25 &	cF 0,5 & cF 0,25\\
	\midrule
	$\delta(Q_{mean})$			& 	93,7			&	93,6			& 90,1			& 94,6\\
	\midrule
	$\delta(P_{BF}/P_{PA})$	& 91,7			&	91,7			& 100,0		& 100,0\\
	$\delta(P_{PA}/P_{FA})$		& 100,0		&	100,0		& 100,0		& 100,0\\
	$\delta(P_{FA}/P_{VC})$	& 	100,0		&	100,0		& 91,7			& 91,7\\
	\bottomrule
	\end{tabular}%
\end{table}

%Точность определения переходов между режимами работы насоса также была вычислена в ходе исследований разработанных моделей идентификации на модели сердечно-сосудистой системы. В этом случае точность определения перехода $P_{BF}/P_{PA}$ составила не менее 92\%, перехода $P_{PA}/P_{FA}$ -- 100\%.
% и приведена в столбце <<Модель>> таблицы \ref{tbl:sputnik_ps_identification_accuracy}.

% \begin{table} [htbp]%
%     \centering
% 	\caption{Точность определения переходов между режимами работы насоса и средняя точность оценки расхода насоса ($\delta,$ \%)}%
% 	\label{tbl:sputnik_ps_identification_accuracy}% label всегда желательно идти после caption
%     \renewcommand{\arraystretch}{1.5} 
% 	\begin{tabular}{@{}@{\extracolsep{12pt}}lllllll@{}} 
% 	\toprule
% 	& \multicolumn{3}{c}{Спутник 1} & \multicolumn{3}{c}{Спутник 2} \\
% 	\midrule
% 												&	cF 0,5		& cF 0,25		& Модель & cF 0,5 & cF 0,25 & Модель \\
% 	\midrule
% 	$\delta(P_{BF}/P_{PA})$	& 91,7			&	91,7			& 	96,0	& 100,0		& 100,0	& 92,5\\
% 	$\delta(P_{PA}/P_{FA})$		& 100,0		&	100,0		&	100,0	& 100,0		& 100,0	& 100,0\\
% 	$\delta(P_{FA}/P_{VC})$	& 	100,0		&	100,0		&	---	& 91,7			& 91,7		& --- \\
% 	\midrule
% 	$\delta(Q_{mean})$			& 	93,7			&	93,6			&		& 90,1			& 94,6		&\\
% 	\bottomrule
% 	\end{tabular}%
% \end{table}

% -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
% -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
\newpage
\underline{\textbf{В заключении}} сформулированы основные результаты и выводы диссертационной работы: %заключаются в следующем:
\input{../common/concl}

\input{references}      % Список литературы

%\newpage
%\renewcommand{\refname}{\large Публикации по теме диссертационной работы}
%\nocite{*}
%\insertbiblioauthor                          % Подключаем Bib-базы
%\insertbibliofull

%\renewcommand{\refname}{\large Публикации по диссертационной работы}